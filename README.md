Pixel Relationship-Constrained Weakly Supervised Semantic Segmentation for Remote Sensing Images: Enhancing CAM Integrity and Pseudo-Label Quality

## Abstract
Remote sensing image semantic segmentation plays a pivotal role in converting complex image data into quantifiable geographic spatial information, 
underpinning applications such as disaster assessment, urban planning, and agricultural resource investigation. 
Fully supervised semantic segmentation methods rely heavily on labor-intensive pixel-level annotations, prompting a shift towards weakly supervised semantic segmentation (WSSS) that utilises image-level annotations. 
However, remote sensing images are characterised by dense, intricate targets and the absence of distinct backgrounds, leading to challenges such as sparse activation of local regions, 
incomplete localization in class activation maps (CAMs), and noisy, rough boundaries in pseudo-labels generated from image-level supervision. 
To address these issues, we propose an innovative deep learning method with pixel relationship constraints for WSSS in remote sensing images. 
Specifically, we design an image reconstruction (IR) loss function to provide pixel-level supervision, enhancing the completeness of CAMs; 
a pixel relationship constraint (PRC) module to strengthen the global correlation of target regions and improve detailed information extraction; 
and an intersection optimization strategy (IOS) based on the Segment Anything Model (SAM) to refine pseudo-labels and segmentation results by mitigating noise. 
Here we show that our method achieves mean Intersection over Union (mIoU) values of 63.85%, 71.20% and 40.96% on the Vaihingen, Potsdam, and iSAID datasets, respectively, 
reaching 89.25%, 89.02% and 65.66% of the performance of fully supervised methods. 
This work advances WSSS for remote sensing images by addressing key limitations of CAM-based pseudo-label generation, offering a cost-effective alternative to fully supervised approaches 
and facilitating broader applications in geographic information science and earth observation.

# Prerequisite
- Python 3.6, PyTorch 1.8.0, and more in requirements.txt
- CUDA 11.1
- 1 x RTX 3090 GPUs

# Usage

## Install python dependencies
```bash
python3 -m pip install -r requirements.txt
```

## Download Dataset
You may download the iSAID dataset from their official webiste https://captain-whu.github.io/iSAID/dataset.html.
You may download the ISPRS Potsdam and Vaihingen from their official webiste https://www.isprs.org/resources/datasets/.

## Data Preprocessing
ISPRS Potsdam: datasetsprocess---python potsdam_patch_split.py
ISPRS Vaihingen: datasetsprocess---python vaihingen_patch_split.py
iSAID dataset: datasetsprocess---python isaid_split.py
generating image-level: datasetsprocess---python process.py

## 1. Train an image classifier
python train_classification.py

## 2. the generated CAMs
python infer_classification.py

## 3. generating the pseudo-labels
python make_pseudo_labels.py

## 4. generating the refined pseudo-labels
python generate_refined_pseudo.py

## 5. Train the segmentation model using the pseudo-labels
python train_segmentation.py

## 6. generating the segmentation results
python inference_segmentation.py

## 7. generating the refined segmentation results
python generate_refined_seg.py

## 8. Evaluate the pseudo-labels and segmentation results
python evaluate(miou).py
## 9. The segmentation results generated by SAM
PRC_SAM---python get_se_map.py

## Citation
If you find this work useful for your research, please cite our paper:

@article{fan2026weakly,
  title={Pixel Relationship-Constrained Weakly Supervised Semantic Segmentation for Remote Sensing Images: Enhancing CAM Integrity and Pseudo-Label Quality},
  author={Fan, Jiaming and Chen, Dali and Liu, Yang and Liu, Shixin},
  journal={The Visual Computer},
  year={2026},
  publisher={Springer}
}
